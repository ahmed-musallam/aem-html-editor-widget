function CodeFlask(t){this.indent=t||"    "}CodeFlask.prototype.run=function(t,e){var n=document.querySelectorAll(t);if(n.length>1)throw"CodeFlask.js ERROR: run() expects only one element, "+n.length+" given. Use .runAll() instead.";this.scaffold(n[0],!1,e)},CodeFlask.prototype.runAll=function(t,e){this.update=null,this.onUpdate=null;var n,l=document.querySelectorAll(t);for(n=0;n<l.length;n++)this.scaffold(l[n],!0,e)},CodeFlask.prototype.scaffold=function(t,e,n){var l=document.createElement("TEXTAREA"),a=document.createElement("PRE"),i=document.createElement("CODE"),o=t.textContent;1==!n.enableAutocorrect&&(l.setAttribute("spellcheck","false"),l.setAttribute("autocapitalize","off"),l.setAttribute("autocomplete","off"),l.setAttribute("autocorrect","off")),n.language=this.handleLanguage(n.language),this.defaultLanguage=t.dataset.language||n.language||"markup",e||(this.textarea=l,this.highlightCode=i),t.classList.add("CodeFlask"),l.classList.add("CodeFlask__textarea"),a.classList.add("CodeFlask__pre"),i.classList.add("CodeFlask__code"),i.classList.add("language-"+this.defaultLanguage),/iPad|iPhone|iPod/.test(navigator.platform)&&(i.style.paddingLeft="3px"),t.innerHTML="",t.appendChild(l),t.appendChild(a),a.appendChild(i),l.value=o,this.renderOutput(i,l),Prism.highlightAll(),this.handleInput(l,i,a),this.handleScroll(l,a)},CodeFlask.prototype.renderOutput=function(t,e){t.innerHTML=e.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"\n"},CodeFlask.prototype.handleInput=function(t,e,n){var l,a,i,o,s,r=this;t.addEventListener("input",function(t){l=this,r.renderOutput(e,l),Prism.highlightAll()}),t.addEventListener("keydown",function(t){l=this,a=l.selectionStart,i=l.value,o=a-l.value.substr(0,a).split("\n").pop().length,9===t.keyCode&&(t.preventDefault(),t.shiftKey?(s=r.indent.length,i.substring(o,o+s)==r.indent&&(l.value=i.substring(0,o)+i.substring(o+s,l.value.length),l.selectionStart=a-r.indent.length,l.selectionEnd=a-r.indent.length)):(l.value=i.substring(0,a)+r.indent+i.substring(a,l.value.length),l.selectionStart=a+r.indent.length,l.selectionEnd=a+r.indent.length),e.innerHTML=l.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"\n",Prism.highlightAll())})},CodeFlask.prototype.handleScroll=function(t,e){t.addEventListener("scroll",function(){roundedScroll=Math.floor(this.scrollTop),navigator.userAgent.toLowerCase().indexOf("firefox")<0&&(this.scrollTop=roundedScroll),e.style.top="-"+roundedScroll+"px"})},CodeFlask.prototype.handleLanguage=function(t){return t.match(/html|xml|xhtml|svg/)?"markup":t.match(/js/)?"javascript":t},CodeFlask.prototype.onUpdate=function(t){if("function"!=typeof t)throw"CodeFlask.js ERROR: onUpdate() expects function, "+typeof t+" given instead.";this.textarea.addEventListener("input",function(e){t(this.value)})},CodeFlask.prototype.update=function(t){var e=document.createEvent("HTMLEvents");this.textarea.value=t,this.renderOutput(this.highlightCode,this.textarea),Prism.highlightAll(),e.initEvent("input",!1,!0),this.textarea.dispatchEvent(e)};
//# sourceMappingURL=codeflask.min.js.map